{% extends 'base.html' %}

{% block title %}Отзывы — ArtNails Academy{% endblock %}

{% block content %}
<main class="reviews-page">

    <!-- Верхний белый блок -->
    <section class="reviews-header">
        <div class="reviews-header-content">
            <h1 class="reviews-title">Отзывы студентов</h1>
            <button class="btn-add-review">+ Оставить отзыв</button>
        </div>
    </section>

    <!-- Фильтры -->
    <section class="reviews-filters">
        <div class="reviews-filters-card">
            <div class="filter-wrapper">
                <label>Фильтр по курсу</label>
                <select id="review-course-filter">
                    <option value="">Все курсы</option>
                    {% for course in courses %}
                    <option value="{{ course.id_course }}">{{ course.title }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="filter-wrapper">
                <label>Сортировать по</label>
                <select id="review-sort-filter">
                    <option value="newest">Сначала новые</option>
                    <option value="oldest">Сначала старые</option>
                    <option value="rating">По рейтингу</option>
                </select>
            </div>
        </div>
    </section>

    <!-- Список отзывов -->
    <section class="reviews-list-section">
        <div class="reviews-list-container" id="reviews-container">
            {% for review in reviews %}
            <div class="review-card">
                <img
                    class="review-avatar"
                    src="{{ url_for('static', filename=review.user.avatar) if review.user.avatar else url_for('static', filename='img/default_avatar.png') }}"
                    alt="avatar"
                >
                <div class="review-header">
                    <div class="review-name">{{ review.user.first_name }} {{ review.user.last_name }}</div>
                    <div class="review-course">{{ review.course.title }}</div>
                </div>
                <div class="review-stars">
                    {% for i in range(1,6) %}
                        {% if i <= review.rating %}
                            <img src="{{ url_for('static', filename='icons/star-filled.svg') }}" alt="star" class="star">
                        {% else %}
                            <img src="{{ url_for('static', filename='icons/star-empty.svg') }}" alt="star" class="star">
                        {% endif %}
                    {% endfor %}
                </div>
                <div class="review-date">{{ review.created_at.strftime("%d.%m.%Y") }}</div>
                <p class="review-text">{{ review.comment }}</p>
            </div>
            {% endfor %}
        </div>
    </section>
<div class="modal-overlay" id="add-review-modal">
    <div class="modal-content">

        <h2 class="modal-title">Оставить отзыв</h2>

        <label>Курс</label>
        <select id="review-course">
            {% for course in user_courses %}
                <option value="{{ course.id_course }}">{{ course.title }}</option>
            {% endfor %}
        </select>

        <label>Оценка</label>
        <div id="review-rating" class="review-stars-input">
            {% for i in range(1,6) %}
                <span class="star" data-value="{{ i }}">☆</span>
            {% endfor %}
        </div>

        <label>Комментарий</label>
        <textarea id="review-comment" placeholder="Напишите отзыв..."></textarea>

        <div class="modal-buttons">
            <button id="submit-review" class="btn-primary">Отправить</button>
            <button id="close-review-modal" class="btn-secondary">Отмена</button>
        </div>

    </div>
</div>


</main>


<script src="{{ url_for('static', filename='js/reviews_filter.js') }}"></script>
{% endblock %}
