{% extends "base.html" %}

{% block title %}Запись на курсы | ArtNails Academy{% endblock %}

{% block content %}

<!-- Верхний белый блок -->
<section class="enroll-header">
    <div class="enroll-header-inner">
        <h1>Запись на курсы</h1>
        <p>Заполните форму для записи на выбранный курс</p>
    </div>
</section>

<!-- Основной контент -->
<section class="enroll-page">

    <!-- Форма -->
    <form class="enroll-form" id="enrollForm" novalidate>

        <h2>Регистрационная форма</h2>

        <div class="form-group">
            <label>Имя и фамилия</label>
            <input type="text" name="full_name" minlength="3" required>
            <span class="error-text"></span>
        </div>

        <div class="form-group">
            <label>Email</label>
            <input type="email" name="email" required>
            <span class="error-text"></span>
        </div>

        <div class="form-group">
            <label>Телефон</label>
            <input type="tel" name="phone" required>
            <span class="error-text"></span>
        </div>

        <div class="form-group">
            <label>Курс</label>
            <select name="course" id="courseSelect" required>
                <option value="">Выберите курс</option>
                {% for course in courses %}
                    <option
                        value="{{ course.id_course }}"
                        data-price="{{ course.price }}"
                    >
                        {{ course.title }}
                    </option>
                {% endfor %}
            </select>
            <span class="error-text"></span>
        </div>

        <div class="form-group">
            <label>Способ оплаты</label>

            <div class="option-row">
                <input type="radio" name="payment" value="card" required>
                <label>Банковская карта</label>
            </div>

            <div class="option-row">
                <input type="radio" name="payment" value="installment">
                <label>Рассрочка</label>
            </div>

            <div class="option-row">
                <input type="radio" name="payment" value="transfer">
                <label>Банковский перевод</label>
            </div>

            <span class="error-text"></span>
        </div>

        <div class="agreement">
            <input type="checkbox" name="agree" required>
            <label>
                Я согласен(а) с
                <a href="#">условиями обучения</a>
                и
                <a href="#">политикой конфиденциальности</a>
            </label>
        </div>

        <span class="error-text"></span>

        <button type="submit" class="submit-btn">
            Записаться на курс
        </button>

    </form>

    <!-- Сводка заказа -->
    <div class="order-summary">

        <h2 class="summary-title">Сводка заказа</h2>

        <div class="summary-content" id="summaryContent">
            <p class="summary-placeholder">
                Выберите курс для отображения информации
            </p>
        </div>

        <div class="mini-summary-block">
            <p class="bold-text">Гарантия качества</p>
            <p>Возврат средств в течение 14 дней, если курс не подошёл</p>
        </div>

    </div>

</section>
<script>
    document.addEventListener('DOMContentLoaded', () => {
    const enrollHeader = document.querySelector('.enroll-header-inner');
    const enrollForm = document.querySelector('.enroll-form');
    const orderSummary = document.querySelector('.order-summary');

    const headerElements = enrollHeader ? [enrollHeader.querySelector('h1'), enrollHeader.querySelector('p')] : [];
    const formElements = enrollForm ? Array.from(enrollForm.querySelectorAll('h2, .form-group, .agreement, .submit-btn')) : [];
    const summaryElements = orderSummary ? [orderSummary.querySelector('.summary-title'), orderSummary.querySelector('#summaryContent'), orderSummary.querySelector('.mini-summary-block')] : [];

    // Скрываем все элементы изначально
    [...headerElements, ...formElements, ...summaryElements].forEach(el => {
        if(el) {
            el.style.opacity = 0;
            el.style.transform = 'translateY(30px)';
        }
    });

    function animateElements(elements, delayStep = 200) {
        elements.forEach((el, i) => {
            if(el) {
                setTimeout(() => {
                    el.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
                    el.style.opacity = 1;
                    el.style.transform = 'translateY(0)';
                }, i * delayStep);
            }
        });
    }

    animateElements(headerElements, 300);
    animateElements(formElements, 150);
    animateElements(summaryElements, 300);

    // Дополнительно: плавное появление выбранного курса в сводке
    const courseSelect = document.getElementById('courseSelect');
    const summaryContent = document.getElementById('summaryContent');
    if(courseSelect && summaryContent) {
        courseSelect.addEventListener('change', () => {
            summaryContent.style.opacity = 0;
            summaryContent.style.transform = 'translateY(20px)';
            setTimeout(() => {
                const selectedOption = courseSelect.selectedOptions[0];
                if(selectedOption.value) {
                    const price = selectedOption.dataset.price || '—';
                    summaryContent.innerHTML = `<p>Курс: ${selectedOption.text}</p><p>Цена: ${price} ₽</p>`;
                } else {
                    summaryContent.innerHTML = '<p class="summary-placeholder">Выберите курс для отображения информации</p>';
                }
                summaryContent.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                summaryContent.style.opacity = 1;
                summaryContent.style.transform = 'translateY(0)';
            }, 100);
        });
    }
});

</script>
<script src="{{ url_for('static', filename='js/enroll.js') }}"></script>

{% endblock %}
