{% extends 'base.html' %}

{% block title %}Каталог курсов — ArtNails Academy{% endblock %}

{% block content %}
<main class="catalog-page">

    <!-- Верхний белый блок -->
    <section class="catalog-header">
        <div class="catalog-header-content">
            <h1 class="catalog-title">Каталог курсов</h1>
            <p class="catalog-subtitle">
                Выберите курс, который подходит вашему уровню и целям
            </p>
        </div>
    </section>

    <!-- Фильтры -->
    <section class="filter-section">
        <div class="filter-container">

            <!-- Поиск -->
            <div class="filter-item search-filter">
                <label for="search" class="filter-label">Поиск по названию</label>
                <div class="search-input-wrapper">
                    <input
                        type="text"
                        id="search"
                        class="filter-input"
                        placeholder="Введите название курса..."
                        list="search-suggestions"
                        autocomplete="off"
                    >
                    <button type="button" id="clear-search" class="clear-search-btn">✕</button>
                </div>
                <datalist id="search-suggestions"></datalist>
            </div>


            <!-- Уровень -->
            <div class="filter-item">
                <label for="level" class="filter-label">Уровень</label>
                <select id="level" class="filter-select">
                    <option value="">Все уровни</option>
                    <option value="Начинающий">Начинающий</option>
                    <option value="Средний">Средний</option>
                    <option value="Продвинутый">Продвинутый</option>
                </select>
            </div>

            <!-- Цена -->
            <div class="filter-item">
                <label for="price" class="filter-label">Цена</label>
                <select id="price" class="filter-select">
                    <option value="">Все</option>
                    <option value="low">До 800 BYN</option>
                    <option value="medium">801–1200 BYN</option>
                    <option value="high">От 1201 BYN</option>
                </select>
            </div>

            <!-- Длительность -->
            <div class="filter-item">
                <label for="duration" class="filter-label">Длительность</label>
                <select id="duration" class="filter-select">
                    <option value="">Все</option>
                    <option value="short">1–2 недели</option>
                    <option value="medium">3–4 недели</option>
                    <option value="long">5+ недель</option>
                </select>
            </div>

        </div>
    </section>

    <!-- Карточки курсов -->
     <section class="courses-block">
        <div class="courses-container-catalog" id="courses-container">

            {% for course in courses %}
            <div class="course-card public-course-card">

                <!-- Изображение -->
                <img
                    src="{{ url_for('static', filename=course.image) }}"
                    alt="{{ course.title }}"
                    class="course-img"
                >

                <!-- Верхняя информация -->
                <div class="course-top-info">
                    <span class="course-level">{{ course.difficulty }}</span>
                    <span class="course-duration">{{ course.duration_weeks }} недели</span>
                </div>

                <!-- Название -->
                <h3 class="course-name">
                    {{ course.title }}
                </h3>

                <!-- Описание -->
                <p class="course-desc">
                    {{ course.short_description }}
                </p>

                <!-- Цена -->
                <span class="course-price">
                    {{ course.price }} BYN
                </span>

                <!-- Кнопка -->
                <a href="{{ url_for('course_desk.course_page', id_course=course.id_course) }}" class="btn-course-details">
                    Подробнее
                </a>
            </div>
            {% endfor %}

        </div>
    </section>

</main>
<script>
document.addEventListener("DOMContentLoaded", () => {

    // ==========================
    // Верхний блок: заголовок и подзаголовок
    // ==========================
    const catalogTitle = document.querySelector(".catalog-title");
    const catalogSubtitle = document.querySelector(".catalog-subtitle");

    catalogTitle.style.opacity = 0;
    catalogTitle.style.transform = "translateY(20px)";
    catalogSubtitle.style.opacity = 0;
    catalogSubtitle.style.transform = "translateY(20px)";

    setTimeout(() => {
        catalogTitle.style.transition = "all 1s ease";
        catalogTitle.style.opacity = 1;
        catalogTitle.style.transform = "translateY(0)";
    }, 200);

    setTimeout(() => {
        catalogSubtitle.style.transition = "all 1s ease";
        catalogSubtitle.style.opacity = 1;
        catalogSubtitle.style.transform = "translateY(0)";
    }, 600);

    // ==========================
    // Фильтры
    // ==========================
    const filterContainer = document.querySelector(".filter-container");
    filterContainer.style.opacity = 0;
    filterContainer.style.transform = "translateY(20px)";
    setTimeout(() => {
        filterContainer.style.transition = "all 0.8s ease";
        filterContainer.style.opacity = 1;
        filterContainer.style.transform = "translateY(0)";
    }, 1000);

    // ==========================
    // Карточки курсов
    // ==========================
    const courseCards = document.querySelectorAll(".public-course-card");

    function isInViewport(el) {
        const rect = el.getBoundingClientRect();
        return rect.top < window.innerHeight - 50;
    }

    function revealCourses() {
        courseCards.forEach((card, i) => {
            if (isInViewport(card)) {
                setTimeout(() => {
                    card.style.opacity = 1;
                    card.style.transform = "scale(1)";
                    const name = card.querySelector(".course-name");
                    const desc = card.querySelector(".course-desc");
                    const price = card.querySelector(".course-price");
                    const btn = card.querySelector(".btn-course-details");

                    // Появление текста внутри карточки
                    setTimeout(() => { name.style.opacity = 1; name.style.transform = "translateY(0)"; }, 100);
                    setTimeout(() => { desc.style.opacity = 1; desc.style.transform = "translateY(0)"; }, 300);
                    setTimeout(() => { price.style.opacity = 1; price.style.transform = "translateY(0)"; }, 500);
                    setTimeout(() => { btn.style.opacity = 1; btn.style.transform = "translateY(0)"; }, 700);
                }, i * 200); // задержка между карточками
            }
        });
    }

    window.addEventListener("scroll", revealCourses);
    revealCourses();

    // ==========================
    // Clear search button
    // ==========================
    const clearBtn = document.getElementById("clear-search");
    const searchInput = document.getElementById("search");
    clearBtn.addEventListener("click", () => {
        searchInput.value = "";
        searchInput.focus();
    });

});
</script>

<script src="{{ url_for('static', filename='js/catalog_filter.js') }}"></script>
{% endblock %}
